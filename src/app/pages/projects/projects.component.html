<!-- Projects Page -->
<main class="projects">
  <div class="projects__container">
    <div class="projects__content">
      <!-- Header Section -->
      <div class="projects__header animate-fade-in-up">
        <h1 class="projects__title">
          {{ 'projects.title' | translate }} <span class="projects__title-highlight">{{ 'projects.highlight' | translate }}</span>
        </h1>
        <p class="projects__description">
          {{ 'projects.description' | translate }}
        </p>
      </div>

      <!-- Filters -->
      <div class="projects__filters-wrapper animate-fade-in-up-delay">
        <div class="projects__filters">
          <button
            *ngFor="let filter of filters"
            class="filter-btn"
            [class.filter-btn--active]="selectedFilter === filter.id"
            (click)="selectFilter(filter.id)">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect *ngIf="filter.icon === 'grid_view'" x="3" y="3" width="7" height="7"></rect>
              <rect *ngIf="filter.icon === 'grid_view'" x="14" y="3" width="7" height="7"></rect>
              <rect *ngIf="filter.icon === 'grid_view'" x="14" y="14" width="7" height="7"></rect>
              <rect *ngIf="filter.icon === 'grid_view'" x="3" y="14" width="7" height="7"></rect>
              <rect *ngIf="filter.icon === 'desktop_windows'" x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
              <line *ngIf="filter.icon === 'desktop_windows'" x1="8" y1="21" x2="16" y2="21"></line>
              <line *ngIf="filter.icon === 'desktop_windows'" x1="12" y1="17" x2="12" y2="21"></line>
              <ellipse *ngIf="filter.icon === 'database'" cx="12" cy="5" rx="9" ry="3"></ellipse>
              <path *ngIf="filter.icon === 'database'" d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path>
              <path *ngIf="filter.icon === 'database'" d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>
              <polygon *ngIf="filter.icon === 'layers'" points="12 2 2 7 12 12 22 7 12 2"></polygon>
              <polyline *ngIf="filter.icon === 'layers'" points="2 17 12 22 22 17"></polyline>
              <polyline *ngIf="filter.icon === 'layers'" points="2 12 12 17 22 12"></polyline>
            </svg>
            <span>{{ filter.labelKey | translate }}</span>
          </button>
        </div>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoading" class="projects__loading animate-fade-in-up-delay">
        <div class="spinner"></div>
        <p>{{ 'projects.loading' | translate }}</p>
      </div>

      <!-- Error State -->
      <div *ngIf="error && !isLoading" class="projects__error animate-fade-in-up-delay">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <p>{{ error }}</p>
        <button class="btn-retry" (click)="loadProjects()">{{ 'projects.retry' | translate }}</button>
      </div>

      <!-- Projects Grid -->
      <div *ngIf="!isLoading && !error" class="projects__grid">
        <article
          *ngFor="let project of filteredProjects"
          class="project-card animate-fade-in-up"
          [style.animation-delay.ms]="project.delay"
          (click)="openProjectModal(project)">
          <!-- Project Image -->
          <div class="project-card__image-wrapper">
            <div
              class="project-card__image"
              [style.background-image]="'url(' + project.image + ')'">
            </div>
            <div class="project-card__overlay"></div>
            <div class="project-card__badge">
              <span>{{ project.category }}</span>
            </div>
            <div class="project-card__hover">
              <span class="project-card__hover-text">{{ 'projects.view-details' | translate }}</span>
            </div>
          </div>

          <!-- Project Info -->
          <div class="project-card__content">
            <div class="project-card__header">
              <h3 class="project-card__title">{{ project.title }}</h3>
              <svg class="project-card__arrow" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="5" y1="12" x2="19" y2="12"></line>
                <polyline points="12 5 19 12 12 19"></polyline>
              </svg>
            </div>
            <p class="project-card__description">
              {{ project.description }}
            </p>
            <div class="project-card__technologies">
              <span
                *ngFor="let tech of project.technologies"
                class="project-card__tech-tag">
                {{ tech }}
              </span>
            </div>
          </div>
        </article>
      </div>
    </div>
  </div>
</main>

<!-- Project Modal -->
<div *ngIf="isModalOpen && selectedProject" class="modal" (click)="closeModal()">
  <div class="modal__dialog" (click)="$event.stopPropagation()">
    <!-- Close Button -->
    <button class="modal__close" (click)="closeModal()">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>

    <div class="modal__content">
      <!-- Image Section -->
      <div class="modal__image-section">
        <div
          class="modal__image"
          [style.background-image]="'url(' + selectedProject.detailImage + ')'">
        </div>
        <div class="modal__image-overlay"></div>
      </div>

      <!-- Info Section -->
      <div class="modal__info-section">
        <div class="modal__header">
          <div class="modal__meta">
            <span class="modal__category">{{ selectedProject.category }}</span>
            <span class="modal__date">{{ selectedProject.date }}</span>
          </div>
          <h2 class="modal__title">{{ selectedProject.title }}</h2>
        </div>

        <div class="modal__description">
          <p *ngFor="let paragraph of selectedProject.detailedDescription">
            {{ paragraph }}
          </p>
        </div>

        <!-- GitHub Stats -->
        <div class="modal__stats">
          <div class="modal__stat">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" stroke="none">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
            </svg>
            <span class="modal__stat-value">{{ selectedProject.stars }}</span>
            <span class="modal__stat-label">{{ 'projects.modal.stars' | translate }}</span>
          </div>
          <div class="modal__stat">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M12 1v6m0 6v6"></path>
              <path d="M17 7l-5 5-5-5"></path>
            </svg>
            <span class="modal__stat-value">{{ selectedProject.forks }}</span>
            <span class="modal__stat-label">{{ 'projects.modal.forks' | translate }}</span>
          </div>
          <div class="modal__stat">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
            </svg>
            <span class="modal__stat-value">{{ formatRepoSize(selectedProject.size) }}</span>
            <span class="modal__stat-label">{{ 'projects.modal.size' | translate }}</span>
          </div>
        </div>

        <div class="modal__technologies">
          <h4 class="modal__tech-title">
            <span class="modal__tech-indicator"></span>
            {{ 'projects.modal.technologies' | translate }}
          </h4>
          <div class="modal__tech-tags">
            <span
              *ngFor="let tech of selectedProject.detailedTechnologies"
              class="modal__tech-tag">
              {{ tech }}
            </span>
          </div>
        </div>

        <div class="modal__actions">
          <a
            [href]="selectedProject.demoUrl"
            target="_blank"
            rel="noopener noreferrer"
            class="modal__btn modal__btn--primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"></circle>
              <polygon points="10 8 16 12 10 16 10 8"></polygon>
            </svg>
            {{ 'projects.modal.view-demo' | translate }}
          </a>
          <a
            [href]="selectedProject.repoUrl"
            target="_blank"
            rel="noopener noreferrer"
            class="modal__btn modal__btn--secondary">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="16 18 22 12 16 6"></polyline>
              <polyline points="8 6 2 12 8 18"></polyline>
            </svg>
            {{ 'projects.modal.code' | translate }}
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
